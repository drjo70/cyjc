# 🏮 창녕조씨 족보시스템 v3.0

## 📋 프로젝트 개요

**창녕조씨 족보시스템**은 시조 조계룡(趙季龍)부터 45세대까지의 족보 데이터를 체계적으로 관리하는 **최신 웹 기반 PWA 시스템**입니다.

- **개발자**: 닥터조 (주)조유 대표이사 (IT 박사, 컨설팅 전문가)
- **버전**: 3.0 (2024-09-26 OAuth 로그인 시스템 완성)
- **플랫폼**: Cafe24 웹호스팅 (PHP + MySQL)
- **GitHub**: https://github.com/drjo70/cyjc
- **실제 서비스**: https://cyjc.jou.kr
- **연락처**: 010-9272-9081

## ✨ v3.0 주요 업데이트 (2024-09-26)

### 🔐 OAuth 통합 로그인 시스템
1. **Google OAuth 2.0** - 구글 계정으로 간편 로그인
2. **Kakao OAuth 2.0** - 카카오톡 계정으로 간편 로그인  
3. **가족 관계 인증** - 전화번호, 부친명, 형제명으로 가족 관계 검증
4. **접근 권한 관리** - 관리자(level 1) / 일반 사용자(level 2) 권한 시스템
5. **세션 기반 인증** - 안전한 로그인 상태 관리

### 📊 접근 통계 및 분석 시스템
1. **실시간 통계 대시보드** - Chart.js 기반 시각화
2. **페이지별 접근 로그** - 상세한 사용자 활동 추적
3. **사용자별 활동 분석** - 개인화된 통계 정보
4. **시간대별 접속 패턴** - 피크 시간 분석

### 📱 PWA 모바일 최적화 완성
1. **서비스 워커** - 오프라인 지원 및 캐싱
2. **앱 매니페스트** - 홈 화면 설치 지원
3. **푸시 알림** - Firebase 기반 실시간 알림
4. **반응형 디자인** - 모바일 퍼스트 UI/UX

## 🎯 완성된 주요 기능

### 🔐 OAuth 로그인 시스템
- **Google 로그인**: 구글 계정 연동 및 자동 가족 구성원 매칭
- **Kakao 로그인**: 카카오톡 계정 연동 및 프로필 정보 연동
- **가족 관계 인증**: 족보 데이터 기반 본인 확인 시스템
- **권한 기반 접근 제어**: 관리자/일반 사용자 구분 관리

### 📊 족보 관리 시스템  
- **족보 검색**: 다중 조건 검색, 실시간 자동완성
- **인터랙티브 가계도**: D3.js 기반 시각화, 줌/팬 기능
- **개인 상세 정보**: 개인별 족보 정보 및 가족 관계도
- **족보 편집**: 관리자 권한 기반 족보 데이터 CRUD

### 📱 PWA 모바일 앱
- **앱 설치**: 홈 화면에 네이티브 앱처럼 설치
- **오프라인 지원**: 인터넷 없이도 기본 정보 조회
- **푸시 알림**: 중요 업데이트 실시간 알림
- **모바일 최적화**: 터치 친화적 반응형 인터페이스

### 📈 통계 및 분석
- **접근 통계**: 실시간 방문자 수, 페이지뷰 분석  
- **사용 패턴**: 시간대별, 기능별 사용 통계
- **인기 컨텐츠**: 가장 많이 조회된 인물/세대 정보
- **관리자 대시보드**: 시스템 운영 현황 모니터링

## 🏗️ 시스템 구조

```
cyjc/
├── 📁 database/                    # 데이터베이스 스키마
│   ├── setup_auth_tables.sql      # OAuth 인증 테이블
│   ├── access_logs_table.sql      # 접근 로그 테이블  
│   └── push_tokens_table.sql      # 푸시 알림 토큰 테이블
├── 📁 docs/                       # 문서화
│   ├── DEPLOYMENT_GUIDE.md        # 배포 가이드
│   ├── kakao_setup_guide.md       # 카카오 로그인 설정
│   └── capacitor-setup.md         # 모바일 앱 빌드 가이드
├── 📁 public/                     # 정적 자원
│   ├── manifest.json              # PWA 매니페스트
│   ├── sw.js                      # 서비스 워커
│   ├── offline.html               # 오프라인 페이지
│   └── static/                    # CSS, JS, 이미지
├── 📄 config.php                  # 시스템 설정 (환경변수 기반)
├── 📄 index.php                   # 메인 대시보드
├── 📄 login.php                   # 통합 로그인 페이지
├── 📄 auth_callback.php           # Google OAuth 콜백
├── 📄 kakao_callback.php          # Kakao OAuth 콜백
├── 📄 family_verification_system.php # 가족 관계 인증
├── 📄 admin.php                   # 관리자 페이지
├── 📄 admin_stats.php             # 통계 대시보드
├── 📄 family_tree.php             # 인터랙티브 가계도
├── 📄 search.php                  # 고급 검색
├── 📄 person_detail.php           # 개인 상세 정보
└── 📄 .env.example               # 환경변수 템플릿
```

## 🚀 배포 및 접속 URL

### 🌐 주요 페이지 URL
```
https://cyjc.jou.kr/
├── /                              # 메인 대시보드
├── /login.php                     # 🔐 OAuth 통합 로그인  
├── /admin.php                     # ⚙️ 관리자 페이지
├── /admin_stats.php               # 📊 통계 대시보드
├── /family_tree.php               # 📊 인터랙티브 가계도
├── /search.php                    # 🔍 고급 검색
├── /person_detail.php?id=xxx      # 👤 개인 상세 정보
├── /family_verification_system.php # ✅ 가족 관계 인증
└── /my_profile.php               # 👤 개인 프로필
```

### 🔐 OAuth 로그인 방법
1. **Google 로그인**: 구글 계정으로 로그인 후 가족 구성원 자동 매칭
2. **Kakao 로그인**: 카카오톡 계정으로 로그인 후 프로필 연동  
3. **가족 관계 인증**: 이메일이 없는 경우 전화번호/부친명/형제명으로 인증
4. **관리자 권한**: 인증 완료 후 자동으로 적절한 권한 부여

## 🔧 기술 스택 v3.0

### Backend
- **PHP 8.x** (Native, 환경변수 기반 설정)
- **MySQL 5.7+** (UTF8MB4, 관계형 DB 설계)  
- **PDO** (Prepared Statements, SQL Injection 방지)
- **OAuth 2.0** (Google, Kakao 공식 API)

### Frontend
- **TailwindCSS** (유틸리티 퍼스트 CSS 프레임워크)
- **Chart.js** (통계 차트 및 데이터 시각화)
- **D3.js** (인터랙티브 가계도)
- **Font Awesome** (아이콘 시스템)

### PWA & Mobile
- **Service Worker** (오프라인 캐싱, 백그라운드 동기화)
- **Web App Manifest** (네이티브 앱 설치)
- **Firebase** (푸시 알림 서비스)
- **Responsive Design** (모바일 퍼스트 접근법)

## 📊 데이터베이스 구조

### 🗃️ 주요 테이블
1. **user_auth** - OAuth 로그인 정보 (Google/Kakao)
2. **family_members** - 족보 구성원 정보 (600여 명, 45세대)  
3. **access_logs** - 접근 로그 및 통계 데이터
4. **push_tokens** - PWA 푸시 알림 토큰 관리

### 📈 데이터 현황 (2024-09-26)
- **총 인물 수**: 600여 명
- **활성 세대**: 45세대 (시조 → 현재)
- **등록 사용자**: OAuth 기반 확장 가능
- **일일 평균 접속**: 통계 시스템으로 추적

## 🔒 보안 및 인증

### 🛡️ OAuth 2.0 보안
- **CSRF 방지**: state 파라미터 검증
- **토큰 보안**: 서버사이드 토큰 처리
- **세션 관리**: 안전한 세션 쿠키 설정
- **환경변수 분리**: 민감 정보 .env 파일 관리

### 👥 권한 관리 시스템
- **access_level 1**: 관리자 권한 (모든 기능 접근)
- **access_level 2**: 일반 사용자 (조회 및 기본 기능)
- **미인증 사용자**: 제한적 접근 (로그인 페이지로 리다이렉트)

## 📱 PWA 설치 및 사용법

### 📲 모바일 설치 (Android/iOS)
1. **Chrome (Android)**: "홈 화면에 추가" 알림 클릭
2. **Safari (iOS)**: 공유 버튼 → "홈 화면에 추가"
3. **설치 후**: 네이티브 앱처럼 아이콘으로 실행

### 💻 데스크톱 설치
1. **Chrome**: 주소창 오른쪽 설치 아이콘 클릭
2. **Edge**: 설정 → 앱 → "이 사이트를 앱으로 설치"
3. **설치 후**: 독립 실행형 앱 창으로 사용

## 🔄 배포 가이드

### 📋 배포 전 준비사항
1. **환경변수 설정**: `.env` 파일에 OAuth 클라이언트 정보 입력
2. **데이터베이스 설정**: `database/` 폴더의 SQL 파일 실행
3. **파일 권한 설정**: PHP 파일 644, 디렉토리 755
4. **SSL 인증서**: OAuth 리다이렉트를 위한 HTTPS 필수

### 🚀 Cafe24 배포 과정
1. **FTP 업로드**: 전체 파일을 웹 루트에 업로드
2. **DB 설정**: phpMyAdmin에서 SQL 파일 실행
3. **환경변수**: `.env` 파일 생성 및 실제 값 입력
4. **OAuth 설정**: Google/Kakao 개발자 콘솔에서 도메인 등록
5. **테스트**: 로그인 및 주요 기능 동작 확인

## 📈 성능 최적화

### ⚡ 속도 개선
- **이미지 최적화**: WebP 포맷, 지연 로딩
- **CSS/JS 압축**: 프로덕션 빌드 최적화  
- **DB 인덱싱**: 검색 성능 향상
- **CDN 활용**: 정적 자원 글로벌 배포

### 📊 성능 모니터링  
- **접속 통계**: 실시간 사용자 수 추적
- **페이지 성능**: Core Web Vitals 측정
- **오류 추적**: PHP 에러 로그 모니터링
- **사용자 피드백**: 접근성 및 사용성 개선

## 🔧 유지보수 가이드

### 📂 주요 설정 파일
```bash
# 환경변수 (.env)
DB_PASSWORD=실제_비밀번호
GOOGLE_CLIENT_ID=구글_클라이언트_ID  
GOOGLE_CLIENT_SECRET=구글_클라이언트_시크릿
KAKAO_CLIENT_ID=카카오_REST_API_키

# OAuth 리다이렉트 URI
GOOGLE_REDIRECT_URI=https://cyjc.jou.kr/auth_callback.php
KAKAO_REDIRECT_URI=https://cyjc.jou.kr/kakao_callback.php
```

### 🛠️ 일상 관리 작업
- **백업**: 데이터베이스 정기 백업 (주 1회)
- **로그 확인**: access_logs 테이블 모니터링  
- **보안 업데이트**: PHP, 의존성 라이브러리 업데이트
- **성능 분석**: 통계 데이터 기반 최적화

## 📞 지원 및 문의

### 👨‍💻 개발자 정보
- **회사**: (주)조유
- **대표**: 닥터조 (컴퓨터 IT 박사)
- **전문분야**: 시드값 고정 UI/UX, 멀티모델 교차검증, 스파크 페이지 자동 문서화
- **연락처**: 010-9272-9081

### 🌐 온라인 지원
- **GitHub 저장소**: https://github.com/drjo70/cyjc
- **이슈 제보**: GitHub Issues 탭 활용
- **업데이트 알림**: Repository Watch 설정 권장
- **실제 서비스**: https://cyjc.jou.kr (24시간 운영)

---

## 📈 개발 성과 v3.0

### ✅ 완성된 핵심 기능 (2024-09-26)
1. ✅ **OAuth 통합 로그인** - Google/Kakao 2-Way 인증
2. ✅ **가족 관계 인증** - 전화번호/부친명/형제명 검증
3. ✅ **접근 권한 관리** - 역할 기반 접근 제어 (RBAC)
4. ✅ **실시간 통계 시스템** - Chart.js 시각화 대시보드
5. ✅ **PWA 완전 지원** - 오프라인, 푸시알림, 앱설치
6. ✅ **모바일 최적화** - 터치 친화적 반응형 디자인
7. ✅ **보안 강화** - 환경변수 분리, 세션 보안
8. ✅ **GitHub 배포** - 버전 관리 및 지속적 통합

### 🎯 시스템 신뢰성
- **보안**: OAuth 2.0 표준, CSRF/XSS 방지, SQL Injection 차단
- **성능**: 캐싱 전략, DB 최적화, CDN 활용
- **호환성**: 모던 브라우저 100% 지원, PWA 표준 준수  
- **확장성**: 마이크로서비스 아키텍처, API 우선 설계
- **안정성**: 에러 핸들링, 로그 추적, 모니터링 시스템

---

**🏮 창녕조씨 족보시스템 v3.0** - OAuth 인증과 PWA 기술로 완성된 차세대 족보 관리 시스템

*"전통 족보의 디지털 혁신, 사용자 중심의 보안과 편의성을 동시에"* - 닥터조 (주)조유

**🔐 보안 공지**: 이 시스템은 OAuth 2.0 표준을 준수하여 개발되었으며, 개인정보는 암호화되어 안전하게 관리됩니다.